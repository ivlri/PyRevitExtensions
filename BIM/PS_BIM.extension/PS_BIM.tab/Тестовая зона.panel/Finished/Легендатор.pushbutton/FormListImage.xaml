<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Легендатор" Height="600" Width="1000"
        MinWidth="700" MinHeight="350"
        WindowStyle="SingleBorderWindow"
        ResizeMode="NoResize"
        >
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="400"/>
            <ColumnDefinition Width="10"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Левая часть: список и кнопки -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Список в рамке с тонкой границей -->
            <Border Grid.Row="0" BorderThickness="1" BorderBrush="Gray" Margin="0">
                <ListView x:Name="ItemListView"
                          SelectionMode="Single"
                          SelectionChanged="ItemListBox_SelectionChanged"
                          Padding="0"
                          BorderThickness="0"
                          Background="Transparent">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <!-- Добавлен Click -->
                                <CheckBox IsChecked="{Binding checked, Mode=TwoWay}" Click="CheckBox_Click" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding name}" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Border>

            <!-- Кнопки под списком -->
            <Grid Grid.Row="1" Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>  <!-- для кнопки ОК -->
                    <ColumnDefinition Width="*"/>     <!-- растягивающийся промежуток -->
                    <ColumnDefinition Width="Auto"/>  <!-- для кнопки Отмена -->
                </Grid.ColumnDefinitions>

                <Button x:Name="OkButton" IsEnabled="False" Content="ОК" Width="195" Height="30" Margin="0,0,10,0" Click="OkButton_Click" Grid.Column="0" BorderThickness="1" BorderBrush="Gray"/>
                <!-- Левая кнопка с правым отступом 10 -->

                <Button Content="Отмена" Width="195" Height="30" Margin="0" Click="Cancel_Click" Grid.Column="2" BorderThickness="1" BorderBrush="Gray"/>
                <!-- Правая кнопка -->
            </Grid>
        </Grid>

        <!-- Разделитель как прямоугольник с тем же цветом -->
        <Rectangle Grid.Column="1" Width="1" Fill="Gray" VerticalAlignment="Stretch" Margin="5,0"/>

        <!-- Превью в рамке -->
        <Border Grid.Column="2" BorderThickness="1" BorderBrush="Gray" Margin="0">
            <Grid x:Name="ImageContainer"
                  ClipToBounds="True"
                  Background="Transparent"
                  MouseWheel="ImageContainer_MouseWheel"
                  MouseLeftButtonDown="ImageContainer_MouseLeftButtonDown"
                  MouseLeftButtonUp="ImageContainer_MouseLeftButtonUp"
                  MouseMove="ImageContainer_MouseMove"
                  Cursor="Hand">
                <Image x:Name="ItemImage"
                       Stretch="Uniform"
                       SnapsToDevicePixels="True" 
                       UseLayoutRounding="True"
                       RenderOptions.BitmapScalingMode="HighQuality"
                       RenderTransformOrigin="0.5,0.5">
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform x:Name="imageScale" ScaleX="1" ScaleY="1"/>
                            <TranslateTransform x:Name="imageTranslate" X="0" Y="0"/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>
            </Grid>
        </Border>
    </Grid>
</Window>
